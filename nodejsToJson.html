<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Blog by Jerry wu</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name"> Blog</h1>
      <h2 class="project-tagline">by Jerry wu</h2>

    </section>

    <section class="main-content">
    <blockquote>
      <p>nodejs 依赖模块node-xlsx 和 fs 来读execl，输出JSON </p>
    </blockquote>

    <pre>
    // 在操作文件中直接引用
    var fs = require("fs") ;
    var xlsx = require("node-xlsx");

    // 读取excel
    var list = xlsx.parse("test.xlsx");

    // console.log( list[0].data );
    var VIP_NH = [];
    var VIP_SH = [];
    var VIP_CD = [];
    var VIP_BJ = [];
    var VIP_HZ = [];

    var arr = list[0].data;

    for (var i = 1; i < arr.length; i++) {
      VIP_NH.push(arr[i][1]+"");
      VIP_SH.push(arr[i][2]+"");
      VIP_CD.push(arr[i][3]+"");
      VIP_BJ.push(arr[i][4]+"");
      VIP_HZ.push(arr[i][5]+"");
    };

    var brand_id_filter_arr = {
      "VIP_NH":VIP_NH,
      "VIP_SH":VIP_SH,
      "VIP_CD":VIP_CD,
      "VIP_BJ":VIP_BJ,
      "VIP_HZ":VIP_HZ
    };

    // console.log( brand_id_filter_arr);
    var data_str = JSON.stringify( brand_id_filter_arr );

    //写入文件
    fs.writeFile('test.txt', data_str, function (err) {
        if (err) throw err;
        console.log(' test.txt 文件被保存, It\'s brand_id_filter_arr saved!'); //文件被保存
    });


    </pre>
    <h3>输出结果：</h3>
    <pre>
    {
      "VIP_NH": [
        "595389",
        "595527",
        "587315",
        "591509",
        "591507",
        "595407",
        "591994",
        "591995",
        "585192",
        "592821",
        "597252",
        "597340",
        "593025",
        "593032",
        "586354",
        "585767",
        "587390",
        "593141",
        "593148",
        "589224",
        "589226",
        "592309",
        "592312",
        "593090",
        "598483",
        "592913",
        "589213",
        "588170",
        "587223",
        "586048",
        "591188",
        "582400",
        "570274",
        "587178",
        "585945",
        "585955",
        "580211",
        "585990",
        "593208",
        "587552",
        "598412",
        "598987",
        "598992",
        "597082",
        "583524",
        "599393",
        "599157",
        "588051",
        "587979",
        "590250",
        "586314",
        "597168",
        "590710",
        "590711",
        "598301",
        "589015",
        "589060",
        "589004",
        "589025",
        "589050",
        "589055",
        "580064",
        "580095",
        "580070",
        "580080",
        "580090",
        "588888",
        "585058",
        "580085",
        "580102",
        "588207",
        "588206",
        "598371",
        "588877",
        "595128",
        "595108",
        "585858",
        "585868",
        "586088",
        "585925",
        "597561",
        "595698",
        "595102",
        "588887",
        "593073",
        "589099",
        "589244",
        "598543",
        "588211",
        "595277"
      ],
      "VIP_SH": [
        "595389",
        "595527",
        "587316",
        "591509",
        "591507",
        "595407",
        "591994",
        "591995",
        "585192",
        "592821",
        "597252",
        "597340",
        "593025",
        "593032",
        "586355",
        "585768",
        "587393",
        "593141",
        "593148",
        "589224",
        "589226",
        "592309",
        "592312",
        "593090",
        "598483",
        "592913",
        "589213",
        "588171",
        "587224",
        "586049",
        "591189",
        "582401",
        "570275",
        "587179",
        "585946",
        "585956",
        "580212",
        "585991",
        "593209",
        "587552",
        "598412",
        "598988",
        "598993",
        "597083",
        "583525",
        "599393",
        "599157",
        "588052",
        "587980",
        "590251",
        "586315",
        "597168",
        "590710",
        "590711",
        "598302",
        "589016",
        "589061",
        "589005",
        "589026",
        "589051",
        "589056",
        "580065",
        "580096",
        "580071",
        "580081",
        "580091",
        "588888",
        "585059",
        "580086",
        "580103",
        "588207",
        "588206",
        "598371",
        "588878",
        "595129",
        "595109",
        "585859",
        "585869",
        "586089",
        "585926",
        "597561",
        "595698",
        "595102",
        "588887",
        "593073",
        "589099",
        "589244",
        "598543",
        "588211",
        "595277"
      ],
      "VIP_CD": [
        "595389",
        "595527",
        "587317",
        "591509",
        "591507",
        "595407",
        "591994",
        "591995",
        "585192",
        "592821",
        "597252",
        "597340",
        "593025",
        "593032",
        "586356",
        "585769",
        "587395",
        "593141",
        "593148",
        "589224",
        "589226",
        "592309",
        "592312",
        "593090",
        "598483",
        "592913",
        "589213",
        "588172",
        "587225",
        "586050",
        "591190",
        "582402",
        "570276",
        "587180",
        "585947",
        "585957",
        "580213",
        "585992",
        "593210",
        "587564",
        "598412",
        "598989",
        "598994",
        "597084",
        "583526",
        "599393",
        "599157",
        "588053",
        "587981",
        "590252",
        "586316",
        "597168",
        "590710",
        "590711",
        "598303",
        "589017",
        "589062",
        "589006",
        "589027",
        "589052",
        "589057",
        "580066",
        "580097",
        "580072",
        "580082",
        "580092",
        "588888",
        "585060",
        "580087",
        "580104",
        "588207",
        "588206",
        "598371",
        "588879",
        "595130",
        "595110",
        "585860",
        "585870",
        "586090",
        "585927",
        "597561",
        "595698",
        "595102",
        "588887",
        "593073",
        "589099",
        "589244",
        "598543",
        "588211",
        "595277"
      ],
      "VIP_BJ": [
        "595389",
        "595527",
        "587318",
        "591509",
        "591507",
        "595407",
        "591994",
        "591995",
        "585192",
        "592821",
        "597252",
        "597340",
        "593025",
        "593032",
        "586357",
        "585770",
        "587396",
        "593141",
        "593148",
        "589224",
        "589226",
        "592309",
        "592312",
        "593090",
        "598483",
        "592913",
        "589213",
        "588173",
        "587226",
        "586051",
        "591191",
        "581187",
        "570277",
        "587181",
        "585948",
        "585958",
        "580214",
        "585993",
        "593211",
        "587565",
        "598412",
        "598990",
        "598995",
        "597085",
        "583527",
        "599393",
        "599157",
        "588054",
        "587982",
        "590253",
        "586317",
        "597168",
        "590710",
        "590711",
        "598304",
        "589018",
        "589063",
        "589007",
        "589028",
        "589053",
        "589058",
        "580067",
        "580098",
        "580073",
        "580083",
        "580093",
        "588888",
        "585061",
        "580088",
        "580105",
        "588207",
        "588206",
        "598371",
        "588880",
        "595131",
        "595111",
        "585861",
        "585871",
        "586091",
        "585928",
        "597561",
        "595698",
        "595102",
        "588887",
        "593073",
        "589099",
        "589244",
        "598543",
        "588211",
        "595277"
      ],
      "VIP_HZ": [
        "595389",
        "595527",
        "587319",
        "591509",
        "591507",
        "595407",
        "591994",
        "591995",
        "585192",
        "592821",
        "597252",
        "597340",
        "593025",
        "593032",
        "586358",
        "585771",
        "587390",
        "593141",
        "593148",
        "589224",
        "589226",
        "592309",
        "592312",
        "593090",
        "598483",
        "592913",
        "589213",
        "588174",
        "587227",
        "586052",
        "591192",
        "582403",
        "570278",
        "587182",
        "585949",
        "585959",
        "580215",
        "585994",
        "593212",
        "587566",
        "598412",
        "598991",
        "598996",
        "597090",
        "583528",
        "599393",
        "599157",
        "588055",
        "587983",
        "590254",
        "586318",
        "597168",
        "590710",
        "590711",
        "598305",
        "589019",
        "589064",
        "589008",
        "589029",
        "589054",
        "589059",
        "580068",
        "580099",
        "580074",
        "580084",
        "580094",
        "588888",
        "585062",
        "580089",
        "580106",
        "588207",
        "588206",
        "598371",
        "588881",
        "595132",
        "595112",
        "585862",
        "585872",
        "586092",
        "585929",
        "597561",
        "595698",
        "595102",
        "588887",
        "593073",
        "589099",
        "589244",
        "598543",
        "588211",
        "595277"
      ]
    }  
    </pre>
    <footer class="site-footer">
      <span class="site-footer-owner"><a href="https://github.com/wwb568109135/blog">Blog</a> is maintained by <a href="https://github.com/wwb568109135">wwb568109135</a>.</span>

      <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
    </footer>

    </section>

  
  </body>
</html>
